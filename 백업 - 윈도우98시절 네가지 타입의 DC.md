# 윈도우 DC 의 4가지 종류 (VCL관련)
## magicpotato.

오늘은 DC에 대해서 써볼려고 합니다 -_-;

그냥 개인적인 생각이며 정확하지 않으므로..
틀린 내용이 있을땐 지적을 부탁 드립니다.


윈도우즈 게임 프로그래밍이라는.. (Black Art of)책에서는
DC의 종류가 4가지가 있다고 합니다.



첫번째는.. 우리가 일반적으로 사용하는 DC함수..
GetDC/ReleaseDC(언제나), BeginPaint/EndPaint(WM_PAINT)로 얻어서 사용하는
DC라고 합니다. 이것은.. 윈도우에서 공통으로 사용하는 DC에서
작은 캐쉬를 얻어서 사용을 한다고 합니다.

(제생각) DC를 얻으면 기본적으로 디폴트 값이 있는데..
배경색, 폰트, 브러쉬, 매핑 이런 정보 입니다.

DC를 쓰면 원상복구 시키고 되돌리지 않으면..
다른 프로그램에서 해제하지 않은 브러쉬와 폰트를 사용해서..
그리는 경우를 가끔 찾아볼수 있을것 같습니다.
(기본 DC만 얻어서 셋팅 안하고 바로 그리는 프로그램에서 말이죠)

즉.. 장치설정은 한가지이고.. 그리는 영역은 별개로 생성하는것 같습니다.



두번째는.. 클래스 DC라는건데
클래스를 윈도우에 선언할때 CS_CLASSDC 스타일 플래그를 추가하면
이것을 사용할수 있다고 합니다.

DC를 한번만 얻어놓으면
종료시까지 Get/Begin/Release/End를 할 필요가 없다고 합니다.

이것을 사용하면. 1번째에 설명한 '윈도우 공통 DC'가 아닌..
'클래스 공통 DC 캐쉬'를 사용하게 되는것 같습니다. (이해가 우어 -_-;;)

공통DC처럼.. 셋팅은 한가지이고.. 이런걸 (대빵DC -_- 라면 어울릴까요)
클래스 전용으로 하나를 더 만든겁니다. 그 클래스에서 나온 윈도우에 사용..

(제생각) 에로.. 클래스DC를 설정한 클래스 윈도우10개를 생성한뒤에..
1번에서 브러쉬/폰트를 셋팅하고 사용한뒤에..
2~10번에서 셋팅하지 않고 사용할때 1번과 동일한 효과를 얻을수 있는..것..
같습니다. (생각일 뿐입니다 책의 설명이 완벽하지 않아요 -_-;)



그리고 프라이빗 DC라는게 있는데..
클래스DC와 비슷하나, 역시 CS_OWNDC스타일 플래그를 추가하면 사용한답니다.

차이점이라면.. 10개를 만들면 10개에 모두 전용/영구 DC가 생긴다는겁니다.
즉.. 윈도우를 1개만 만들꺼면 클래스든 프라이빗이든 상관이 없다는 뜻 입니다.

(제생각) 10개일때.. 대빵DC가 10개 생긴다는 뜻 입니다 -_-;
기본값이고 뭐고 없이 전용DC인것 같습니다.

왜쓰는지는 안나와있고 -_- 속도때문에 그런것일까 추측해 봅니다....


네번째는 윈도우 DC인데.. 첫번째 DC와 동일하다고 생각하시면 쉽습니다.


CreateParams() 에서 플래그 확인을 해보니..
빌더의 Canvas..즉.. DC는.. 2번째 '클래스 DC'를 사용하는것 같습니다.

'셋팅'의 개념은 적용되지 않는데.. (WM_PAINT에서 빌더가 내부적으로 다시..)
'릴리즈 하지 않고도 언제든지 사용이 가능하다'는것이 끌립니다.

언제 어디서나 TextOut(Canvas->Handle, ...)를 하면 효과가 나타납니다.
이것은 클래스DC를 다는겁니다.


WM_PAINT에서 Canvas를 건드릴 일이 있다면
BeginPaint, GetDC를 사용하지 말고.. 바로 Canvas->Handle를 사용 하십시오.

WM_PAINT내부에서 Canvas->TextOut()과 같은..
클래스 하부의 메소드를 사용하면.. 내부적으로 DC를 건드려서..
다시 WM_PAINT를 발생시켜서 무한루프가 돌지도 모릅니다.
(전 한번 겪어봤는데 정확한 상황기억이 안되네요)

그러니까.. GDI API이걸루.. Canvas->Handle를 직접 사용하시면 될껍니다.


EOF